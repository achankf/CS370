x = [0.489133 0.228816 0.358974 0.167277 0.399023 0.099878 0.431990 0.425153 0.583883 0.593162 0.875214 0.595360 0.876190 0.590720 0.877411 0.489133]';
y = [0.941636 0.719170 0.716972 0.486447 0.487668 0.260562 0.272283 0.059096 0.054457 0.275702 0.266422 0.492308 0.476190 0.698657 0.705495 0.941636]';
v = [0 1 0 1];

A = [
   0.099878   0.260562
   0.167277   0.486447
   0.228816   0.719170
   0.358974   0.716972
   0.399023   0.487668
   0.425153   0.059096
   0.431990   0.272283
   0.489133   0.941636
   0.489133   0.941636
   0.583883   0.054457
   0.590720   0.698657
   0.593162   0.275702
   0.595360   0.492308
   0.875214   0.266422
   0.876190   0.476190
   0.877411   0.705495
];

n = length(x);
%plot(x,y);
t = [1:n];
[ax bx cx dx] = MySpline(t,x);
[ay by cy dy] = MySpline(t,y);

z = 0:0.001:n;
ppx = pwCEval(ax,bx,cx,dx,t,z);
ppy = pwCEval(ay,by,cy,dy,t,z);
%plot(z, ppx,x,y, '*');
plot(x,y, ppx, ppx);

coy =[
        7.693750   -3.850608   -0.233263    0.941636;
      -22.456481    4.053029   -0.163948    0.719170;
        9.964208   -4.716893   -0.250368    0.716972;
      -10.927009    4.245388   -0.391732    0.486447;
        5.945735   -3.351590   -0.184595    0.487668;
       -8.070383    3.347815   -0.186013    0.260562;
       14.007723   -4.698003   -0.634705    0.272283;
        0.810201    4.265396   -0.726979    0.059096;
      -14.680374    4.651370    0.688983    0.054457;
       10.262016   -5.101073    0.589401    0.275702;
       -6.370717    3.586891    0.162092    0.266422;
        7.546737   -3.286651    0.270071    0.492308;
       -5.444604    3.081864    0.212467    0.476190;
        6.463590   -2.829638    0.303751    0.698657;
       -4.827629    2.731102    0.275494    0.705495;
				];
cox = [
        6.514099    0.200534   -1.592698    0.489133;
      -43.282052    6.892339    0.836091    0.228816;
       21.490611  -10.010586    0.430169    0.358974;
      -25.742158    9.319088    0.222847    0.167277;
       14.395937   -8.578087    0.394573    0.399023;
      -14.340061    7.642651    0.043237    0.099878;
       22.316697   -6.653763    0.371863    0.431990;
      -31.361291    7.626464    0.579337    0.425153;
       21.056140   -7.313846    0.628980    0.583883;
      -17.219312    6.674137    0.487323    0.593162;
       14.876758   -7.903971    0.140258    0.875214;
      -19.222369    8.146974    0.227652    0.595360;
       14.393976   -8.074331    0.248086    0.876190;
      -14.911823    7.553989    0.059765    0.590720;
        4.016197   -5.274915    0.713341    0.877411;
];
%newx = pwCEval(cox(:,4), cox(:,3), cox(:,2), cox(:,1) , t, z);
%newy = pwCEval(coy(:,4), coy(:,3), coy(:,2), coy(:,1) , t ,z);
%plot(newx, newy);
